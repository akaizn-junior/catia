"use strict";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}
/*!
 * Catia
 * Capture user actions in the browser
 * @license MIT - @author (c) 2020 Verdexdesign
 */var defaultIgnoreNodes=["html","body"];var events={focus:"focus",click:"click",doubleClick:"double click",hover:"hoverover",rightClick:"right click"};var actions={type:"type",wait:"wait",press:"press",scrollLeft:"scroll left",scrollRight:"scroll right",scrollDown:"scroll down",scrollUp:"scroll up",input:"input",copy:"copy",paste:"paste",cut:"cut",select:"select",visit:"visit",submit:"submit",reset:"reset"};var digits=["abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ","0123456789","`~!@#$%^&*()_-=+\\|}{][\":';<,.>/?*-+^~´ªºÇç«»ã"].join("");var capturedActions=[];var lastCapturedAction="";var TOKEN_SELECTOR="$";var TOKEN_SPACE=" ";var lastKnownScrollPositionY=0;var lastKnownScrollPositionX=0;var ticking=false;function isObject(obj){if(obj){var type=Object.prototype.toString.call(obj);type=type.replace(/[\s[\]]/g,"").toLowerCase().substring(0,6);return type==="object"}return false}function isEditable(node){var contentEditable=node.contentEditable==="true";var name=getNodeName(node);var editables=["input","textarea"];return editables.includes(name)||contentEditable}function captureScrollPosition(opts,scroolData){var currentPositionX=scroolData.currentPositionX,currentPositionY=scroolData.currentPositionY,maxY=scroolData.maxY,maxX=scroolData.maxX;var halfPointY=parseInt(maxY/4,10);var halfPointX=parseInt(maxX/4,10);if(currentPositionY<maxY&&currentPositionY>=halfPointY){logAction({opts:opts,captured:action("scrollDown")})}if(currentPositionY>0&&currentPositionY<halfPointY){logAction({opts:opts,captured:action("scrollUp")})}if(currentPositionX<maxX&&currentPositionX>=halfPointX){logAction({opts:opts,captured:action("scrollRight")})}if(currentPositionX>0&&currentPositionX<halfPointX){logAction({opts:opts,captured:action("scrollLeft")})}}function action(cmd){var TOKEN_ACTION=events[cmd]||actions[cmd];var isEvent=Boolean(events[cmd]);return isEvent&&{token:cmd,cmd:TOKEN_ACTION,action:TOKEN_ACTION+TOKEN_SPACE+TOKEN_SELECTOR+TOKEN_SPACE}||!isEvent&&{token:cmd,cmd:TOKEN_ACTION,action:TOKEN_ACTION+TOKEN_SPACE}}function getNodeAttributes(attributes){var attrs={};var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=attributes[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var attr=_step.value;attrs[attr.nodeName]=attr.nodeValue}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator["return"]!=null){_iterator["return"]()}}finally{if(_didIteratorError){throw _iteratorError}}}return attrs}function getNodeName(node){var name=node.nodeName||node.tagName||node.localName;return name.toLowerCase()}function getNodeData(node){var classList=node.classList,attributes=node.attributes,parentNode=node.parentNode,nextElementSibling=node.nextElementSibling,previousElementSibling=node.previousElementSibling,dataset=node.dataset;var name=getNodeName(node);var parentNodeName=parentNode&&getNodeName(parentNode)||"";var prevNodeName=previousElementSibling&&getNodeName(previousElementSibling)||"";var nextNodeName=nextElementSibling&&getNodeName(nextElementSibling)||"";var _attributes=attributes?getNodeAttributes(attributes):[];var pAttributes=parentNode.attributes?getNodeAttributes(parentNode.attributes):[];return{name:name,parentNodeName:parentNodeName,nextNodeName:nextNodeName,prevNodeName:prevNodeName,classList:_toConsumableArray(classList)||[],dataset:dataset||[],attributes:_objectSpread({},_attributes),parentAttributes:_objectSpread({},pAttributes)}}function buildSelectors(opts,data){var _ref;var selectorSpecificity=opts.selectorSpecificity;var attributes=data.attributes,parentAttributes=data.parentAttributes,name=data.name,parentNodeName=data.parentNodeName;var parentSelector=parentNodeName;var attr=Object.entries(attributes)[0];var pAttr=Object.entries(parentAttributes)[0];var s1=selectorSpecificity===1;var s2=selectorSpecificity===2;if(parentAttributes.id&&!parentAttributes["class"]){parentSelector=s1&&"#".concat(parentAttributes.id)||"".concat(parentSelector,"#").concat(parentAttributes.id)}if(parentAttributes["class"]&&!parentAttributes.id){parentSelector=s1&&".".concat(parentAttributes["class"])||"".concat(parentSelector,".").concat(parentAttributes["class"])}if(pAttr&&!parentAttributes["class"]&&!parentAttributes.id){parentSelector=s1&&"[".concat(pAttr[0][0],'="').concat(pAttr[0][1],'"]')||"".concat(parentSelector,"[").concat(pAttr[0][0],'="').concat(pAttr[0][1],'"]')}return attributes.id&&{id:attributes.id,idSelector:"#".concat(attributes.id),specificSelector:s1&&"#".concat(attributes.id)||s2&&"".concat(name,"#").concat(attributes.id)||"".concat(parentSelector," > ").concat(name,"#").concat(attributes.id)}||attributes["class"]&&{class:"".concat(name,".").concat(attributes["class"]),classSelector:".".concat(attributes["class"]),specificSelector:s1&&".".concat(attributes["class"])||s2&&"".concat(name,".").concat(attributes["class"])||"".concat(parentSelector," > ").concat(name,".").concat(attributes["class"])}||attr&&(_ref={},_defineProperty(_ref,attr[0],attr[1]),_defineProperty(_ref,"specificSelector",s1&&"[".concat(attr[0],'="').concat(attr[1],'"]')||s2&&"".concat(name,"[").concat(attr[0],'="').concat(attr[1],'"]')||"".concat(parentSelector," > ").concat(name,"[").concat(attr[0],'="').concat(attr[1],'"]')),_ref)||{name:name,specificSelector:s1&&name||"".concat(parentSelector," > ").concat(name)}}function getSelector(target,options){var ignoreNodes=options.ignoreNodes,selectorSpecificity=options.selectorSpecificity;var nodeSelectors=buildSelectors({selectorSpecificity:selectorSpecificity},getNodeData(target));var selector=nodeSelectors.idSelector||nodeSelectors.classSelector||nodeSelectors.name;return!ignoreNodes.includes(selector)?nodeSelectors.specificSelector:null}function typeEvent(ev,options){var target=ev.target;var captureSpacePress=options.captureSpacePress,typeDigits=options.typeDigits;var value=ev.key||target.value||target.innerHTML||target.textContent;var isValidEditable=isEditable(target);value=captureSpacePress&&value===" "?ev.code:value;return isValidEditable&&typeDigits&&digits.includes(value)?{action:action("type"),value:value}:{action:action("press"),value:value}}function logAction(data){var opts=data.opts,o=data.captured;for(var _len=arguments.length,r=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){r[_key-1]=arguments[_key]}var rest=(r===null||r===void 0?void 0:r.join(""))||"";var capturedAction=((o===null||o===void 0?void 0:o.action)||"")+rest;var event=new CustomEvent("catiacapture",{detail:{actions:capturedActions,lastAction:capturedAction}});var ignoreForTheseTokens=["type","press"];var canDispatch=lastCapturedAction!==capturedAction||ignoreForTheseTokens.includes(o.token)||opts.registerMultipleTimes;if(canDispatch){capturedActions.push(capturedAction);window.dispatchEvent(event)}lastCapturedAction=capturedAction}function capture(opts){console.info("Capturing actions with catia");var selectorSpecificity=opts.selectorSpecificity,ignoreNodes=opts.ignoreNodes;return function(){var waitCount=0;window.addEventListener("load",(function(){logAction({opts:opts,captured:action("visit")},opts.visitPath||location.href);opts.showWait&&setTimeout((function(){setInterval((function(){logAction({opts:opts,captured:action("wait")},waitCount);waitCount++}),1e3)}),opts.waitTimeout||5e3)}),false);window.addEventListener("mouseover",(function(ev){waitCount=0;var selector=getSelector(ev.target,{ignoreNodes:ignoreNodes,selectorSpecificity:selectorSpecificity});var elem=selector&&document.querySelector(selector);selector&&opts.captureHover&&logAction({opts:opts,captured:action("hover")},selector);if(elem){elem.addEventListener("focus",(function(e){var target=e.target;var isFocusable=Number(target.tabIndex)>=0;if(isFocusable&&opts.captureFocusOnClick){logAction({opts:opts,captured:action("focus")},selector)}}),false);elem.addEventListener("input",(function(e){if(e.target.type==="color"){logAction({opts:opts,captured:action("input")},e.target.value)}}),false)}}),false);window.addEventListener("click",(function(ev){waitCount=0;getSelector(ev.target,{ignoreNodes:ignoreNodes,selectorSpecificity:selectorSpecificity})&&logAction({opts:opts,captured:action("click")},getSelector(ev.target,{ignoreNodes:ignoreNodes,selectorSpecificity:selectorSpecificity}))}),false);window.addEventListener("dblclick",(function(ev){waitCount=0;getSelector(ev.target,{ignoreNodes:ignoreNodes,selectorSpecificity:selectorSpecificity})&&logAction({opts:opts,captured:action("doubleClick")},getSelector(ev.target,{ignoreNodes:ignoreNodes,selectorSpecificity:selectorSpecificity}))}),false);window.addEventListener("keydown",(function(ev){waitCount=0;if(ev.keyCode===9){getSelector(ev.target,{ignoreNodes:ignoreNodes,selectorSpecificity:selectorSpecificity})&&logAction({opts:opts,captured:action("focus")},getSelector(ev.target,{ignoreNodes:ignoreNodes,selectorSpecificity:selectorSpecificity}))}if(ev.target.type!=="password"||opts.capturePasswordInput){var typeEvOpts={captureSpacePress:opts.captureSpacePress,typeDigits:isEditable(ev.target)};var typed=typeEvent(ev,typeEvOpts);typed.value.length&&logAction({opts:opts,captured:typed.action},typed.value)}}),false);window.addEventListener("contextmenu",(function(ev){waitCount=0;logAction({opts:opts,captured:action("rightClick")},getSelector(ev.target,{ignoreNodes:ignoreNodes,selectorSpecificity:selectorSpecificity})||"document")}),false);opts.captureScroll&&window.addEventListener("scroll",(function(){waitCount=0;lastKnownScrollPositionY=window.scrollY;lastKnownScrollPositionX=window.scrollX;var maxY=window.scrollMaxY;var maxX=window.scrollMaxX;if(!ticking){window.requestAnimationFrame((function(){captureScrollPosition(opts,{currentPositionX:lastKnownScrollPositionX,currentPositionY:lastKnownScrollPositionY,maxY:maxY,maxX:maxX});ticking=false}));ticking=true}}));window.addEventListener("selectstart",(function(){waitCount=0;logAction({opts:opts,captured:action("select")})}),false);window.addEventListener("select",(function(){waitCount=0;logAction({opts:opts,captured:action("select")})}),false);window.addEventListener("copy",(function(){waitCount=0;logAction({opts:opts,captured:action("copy")})}),false);window.addEventListener("paste",(function(){waitCount=0;logAction({opts:opts,captured:action("paste")})}),false);window.addEventListener("cut",(function(){waitCount=0;logAction({opts:opts,captured:action("cut")})}),false);window.addEventListener("submit",(function(){waitCount=0;logAction({opts:opts,captured:action("submit")})}),false);window.addEventListener("reset",(function(){waitCount=0;logAction({opts:opts,captured:action("reset")})}),false)}}function catia(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var opts=isObject(options)&&options||{};var ignoreNodes="ignoreNodes"in opts&&opts.ignoreNodes||defaultIgnoreNodes;window.addEventListener("catiacapture",(function(e){callback(_objectSpread({},e.detail))}),false);return{capture:capture(_objectSpread({ignoreNodes:ignoreNodes},opts))}}window.catia=catia;